<html>
  <head>
    <script
      type="text/javascript"
      src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"
    ></script>

    <style type="text/css">
      #network {
        width: 100%;
        height: 90%;
        border: 1px solid black;
        text-align: center;
      }
    </style>
  </head>
  <body>
    <div id="network"></div>
    <input type="file" id="files" name="files[]" />

    <script type="text/javascript">
      document
        .getElementById("files")
        .addEventListener("change", handleFileSelect, false);

      // https://www.sitepoint.com/community/t/build-an-array-from-csv-file/234312/3
      function parseCSV(file, delimiter, callback) {
        var reader = new FileReader();

        reader.onload = function() {
          var lines = this.result.split("\n");

          var result = lines.map(function(line) {
            // Replacing /r is if the original file uses /r/n as new line
            return line.replace(/\r/g, "").split(delimiter);
          });

          callback(result);
        };

        reader.readAsText(file);
      }

      function handleFileSelect(event) {
        var files = event.target.files; // FileList object

        //for (var i = 0; i < files.length; i++) {
        //parseCSV(files[i], ",", function(result) {
        //  createGraph(getNodes(result), getEdges(result));
        //});
        //}

        parseCSV(files[0], ",", function(result) {
          createGraph(getNodes(result), getEdges(result));
        });
      }

      function getNodes(array) {
        var nodes = [];

        for (var i = 1; i < array.length; i++) {
          nodes.push({ id: i, label: array[0][i] });
        }

        return nodes;
      }

      function getEdges(array) {
        var edges = [];

        for (var i = 1; i < array.length; i++) {
          for (var j = 1; j < array.length; j++) {
            if (array[i][j]) {
              edges.push({ from: i, to: j, label: array[i][j] });
            }
          }
        }

        return edges;
      }

      function createGraph(nodes, edges) {
        var container = document.getElementById("network");
        container.innerHTML = "";

        var data = {
          nodes: nodes,
          edges: edges
        };

        var fontOptions = {
          color: "#ffffff",
          size: 16, // px
          face: "arial",
          background: "none",
          strokeWidth: 0, // px
          strokeColor: "#ffffff",
          align: "center",
          multi: false,
          vadjust: 0
        };

        var baseColor = "#27408b";
        var highlightColor = "#1e90ff";
        var transparentColor = "rgba(0,0,0,0)";

        var options = {
          //layout: {
          //  randomSeed: 8
          //},
          physics: {
            enabled: true,
            barnesHut: {
              gravitationalConstant: -1000,
              centralGravity: 0.3,
              springLength: 10,
              springConstant: 0,
              damping: 0.09,
              avoidOverlap: 0
            },
            solver: "barnesHut"
          },
          interaction: {
            hover: true
          },
          nodes: {
            color: {
              border: transparentColor,
              background: baseColor,
              highlight: {
                border: transparentColor,
                background: highlightColor
              },
              hover: {
                border: transparentColor,
                background: highlightColor
              }
            },
            font: {
              color: "#ffffff"
            }
          },
          edges: {
            arrows: {
              to: {
                enabled: true
              }
            },
            color: {
              color: baseColor,
              highlight: highlightColor,
              hover: highlightColor
            },
            font: {
              color: "#000000"
            }
          }
        };

        var network = new vis.Network(container, data, options);
      }
    </script>
  </body>
</html>
